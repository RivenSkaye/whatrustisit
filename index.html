<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>What Rust is it?</title>
<link href="https://code.cdn.mozilla.net/fonts/fira.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="gh-fork-ribbon.css">
<link href="style.css" rel="stylesheet" type="text/css">
</head>
<body>
  <a href="https://www.rust-lang.org/" class="brand">Rust</a>
  <h1>What Rust is it?</h1>
  <div class="github-fork-ribbon-wrapper right-bottom">
    <div class="github-fork-ribbon">
      <a href="https://github.com/badboy/whatrustisit">Fork me on GitHub</a>
    </div>
  </div>

  <div id="flex-container">
    <h2 id="stable" class="version">
      <div class="vernum">1.56.1</div>
      <div class="branch">Stable</div>
      <div class="relnotes"><a href="https://github.com/rust-lang/rust/blob/1.56.1/RELEASES.md">Release notes</a></div>
    </h2>

    <h2 id="beta" class="version">
      <div class="vernum">1.58.0-beta.1</div>
      <div class="branch">Beta</div>
    </h2>

    <h2 id="nightly" class="version">
      <div class="vernum">1.59.0 (2021-11-30)</div>
      <div class="branch">Nightly</div>
    </h2>
  </div>
  <h2 id="next-release">
    <span>Next release day: Soon</span>
  </h2>

  <script type="text/javascript" src="dayjs.min.js"></script>
  <script>
    /* from https://github.com/rust-lang/rust-forge/blob/f13e6b49e117ec84179cb969efc94894ceaa8325/js/index.js */

    // Rust 1.5.0 was released on 2015-12-10
    const EPOCH_DATE = dayjs.utc('2015-12-10')
    const EPOCH_RELEASE = 5
    const newReleases = Math.floor(dayjs.utc().diff(EPOCH_DATE, 'weeks') / 6)
    const releaseNumber = EPOCH_RELEASE + newReleases + 1
    const displayVersion = `1.${releaseNumber}`
    const releaseDate = EPOCH_DATE.clone().add((newReleases + 1) * 6, 'weeks')

    const nextDate = releaseDate.format('YYYY-MM-DD')
    const diffDays = releaseDate.diff(dayjs.utc(), 'days')
    const dayWord = "days";
    if (diffDays == 1) {
      dayWord = "day"
    }

    let toWrite = "";
    toWrite += "<span>Next release day: " + nextDate + "</span>";
    toWrite += " <span>(in "+ diffDays + " " + dayWord + ")</span>"

    document.getElementById('next-release').innerHTML = toWrite;
  </script>
</body>
</html>
